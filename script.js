// Traduções
const translations = {
    pt: {
        brand: "FidelityPro",
        nav: {
            home: "Início",
            plans: "Planos",
            benefits: "Benefícios",
            testimonials: "Depoimentos",
            faq: "FAQ",
            cart: "Carrinho"
        },
        hero: {
            title: "Teste de Fidelidade Profissional",
            subtitle: "Planos personalizados de teste de fidelidade com acompanhamento profissional e resultados garantidos",
            cta: "Ver Planos"
        },
        plans: {
            title: "Escolha Seu Plano",
            subtitle: "Planos flexíveis para seu teste de fidelidade",
            basic: {
                name: "Básico",
                price: "R$ 97",
                period: "/mês",
                features: [
                    "Teste de fidelidade básico",
                    "Suporte via WhatsApp",
                    "Relatório detalhado",
                    "Acompanhamento semanal"
                ],
                button: "Assinar Básico"
            },
            pro: {
                name: "Pro",
                price: "R$ 197",
                period: "/mês",
                popular: "Mais Popular",
                features: [
                    "Tudo do plano Básico",
                    "Teste avançado de fidelidade",
                    "Consultas mensais",
                    "Grupo VIP no Telegram",
                    "Análise comportamental"
                ],
                button: "Assinar Pro"
            },
            premium: {
                name: "Premium",
                price: "R$ 297",
                period: "/mês",
                features: [
                    "Tudo do plano Pro",
                    "Acompanhamento diário",
                    "Consultas semanais",
                    "Teste completo de fidelidade",
                    "Suporte 24/7",
                    "Garantia de resultado"
                ],
                button: "Assinar Premium"
            }
        },
        benefits: {
            title: "Por Que Escolher a FidelityPro?",
            security: {
                title: "Segurança",
                description: "Métodos comprovados e discretos com total confidencialidade"
            },
            speed: {
                title: "Rapidez",
                description: "Resultados precisos em apenas 15 dias com nosso método exclusivo"
            },
            support: {
                title: "Suporte",
                description: "Equipe especializada disponível para te ajudar em todo processo"
            }
        },
        testimonials: {
            title: "O Que Nossos Clientes Dizem",
            client1: {
                name: "Maria Silva",
                text: "Descobri a verdade em 2 semanas! O acompanhamento é incrível e os resultados são precisos.",
                rating: 5
            },
            client2: {
                name: "João Santos",
                text: "Método revolucionário! Nunca pensei que seria tão fácil descobrir a verdade de forma discreta.",
                rating: 5
            },
            client3: {
                name: "Ana Costa",
                text: "Suporte excepcional e teste personalizado. Recomendo para todos!",
                rating: 5
            }
        },
        faq: {
            title: "Perguntas Frequentes",
            q1: {
                question: "Como funciona o teste de fidelidade?",
                answer: "Você terá acesso direto aos nossos profissionais via WhatsApp e consultas agendadas conforme seu plano."
            },
            q2: {
                question: "Posso cancelar a qualquer momento?",
                answer: "Sim, você pode cancelar sua assinatura a qualquer momento sem taxas adicionais."
            },
            q3: {
                question: "Os resultados são garantidos?",
                answer: "Sim! Seguindo nosso método corretamente, garantimos resultados em até 30 dias ou seu dinheiro de volta."
            },
            q4: {
                question: "O teste é discreto?",
                answer: "Sim! Nossos métodos são totalmente discretos e confidenciais, garantindo sua privacidade."
            }
        },
        cart: {
            title: "Seu Carrinho",
            empty: "Carrinho vazio",
            total: "Total:",
            checkout: "Finalizar Compra",
            remove: "Remover"
        },
        footer: {
            rights: "© 2024 FidelityPro. Todos os direitos reservados."
        }
    },
    en: {
        brand: "FidelityPro",
        nav: {
            home: "Home",
            plans: "Plans",
            benefits: "Benefits",
            testimonials: "Testimonials",
            faq: "FAQ",
            cart: "Cart"
        },
        hero: {
            title: "Professional Fidelity Test",
            subtitle: "Personalized fidelity test plans with professional guidance and guaranteed results",
            cta: "View Plans"
        },
        plans: {
            title: "Choose Your Plan",
            subtitle: "Flexible plans for your fidelity test",
            basic: {
                name: "Basic",
                price: "$29",
                period: "/month",
                features: [
                    "Basic fidelity test",
                    "WhatsApp support",
                    "Detailed report",
                    "Weekly follow-up"
                ],
                button: "Subscribe Basic"
            },
            pro: {
                name: "Pro",
                price: "$59",
                period: "/month",
                popular: "Most Popular",
                features: [
                    "Everything in Basic",
                    "Advanced fidelity test",
                    "Monthly consultations",
                    "VIP Telegram group",
                    "Behavioral analysis"
                ],
                button: "Subscribe Pro"
            },
            premium: {
                name: "Premium",
                price: "$89",
                period: "/month",
                features: [
                    "Everything in Pro",
                    "Daily monitoring",
                    "Weekly consultations",
                    "Complete fidelity test",
                    "24/7 support",
                    "Result guarantee"
                ],
                button: "Subscribe Premium"
            }
        },
        benefits: {
            title: "Why Choose FidelityPro?",
            security: {
                title: "Security",
                description: "Proven and discreet methods with total confidentiality"
            },
            speed: {
                title: "Speed",
                description: "Accurate results in just 15 days with our exclusive method"
            },
            support: {
                title: "Support",
                description: "Specialized team available to help you throughout the process"
            }
        },
        testimonials: {
            title: "What Our Clients Say",
            client1: {
                name: "Maria Silva",
                text: "Discovered the truth in 2 weeks! The follow-up is incredible and the results are accurate.",
                rating: 5
            },
            client2: {
                name: "João Santos",
                text: "Revolutionary method! Never thought it would be so easy to discover the truth discreetly.",
                rating: 5
            },
            client3: {
                name: "Ana Costa",
                text: "Exceptional support and personalized test. I recommend it to everyone!",
                rating: 5
            }
        },
        faq: {
            title: "Frequently Asked Questions",
            q1: {
                question: "How does the fidelity test work?",
                answer: "You'll have direct access to our professionals via WhatsApp and scheduled consultations according to your plan."
            },
            q2: {
                question: "Can I cancel anytime?",
                answer: "Yes, you can cancel your subscription at any time without additional fees."
            },
            q3: {
                question: "Are results guaranteed?",
                answer: "Yes! Following our method correctly, we guarantee results within 30 days or your money back."
            },
            q4: {
                question: "Is the test discreet?",
                answer: "Yes! Our methods are completely discreet and confidential, ensuring your privacy."
            }
        },
        cart: {
            title: "Your Cart",
            empty: "Empty cart",
            total: "Total:",
            checkout: "Checkout",
            remove: "Remove"
        },
        footer: {
            rights: "© 2024 FidelityPro. All rights reserved."
        }
    }
};

// Estado da aplicação
let currentLanguage = 'pt';
let cartItems = [];
let idCounter = 0;

// Inicialização
document.addEventListener('DOMContentLoaded', function() {
    initializeApp();
    setupIntersectionObserver();
    updateLanguage();
});

function initializeApp() {
    // Configurar eventos de scroll suave
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth'
                });
            }
        });
    });
}

// Observador de interseção para animações
function setupIntersectionObserver() {
    const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
            if (entry.isIntersecting) {
                entry.target.classList.add('animate');
            }
        });
    }, { threshold: 0.1 });

    document.querySelectorAll('.fade-in').forEach((el) => {
        observer.observe(el);
    });
}

// Navegação
function scrollToSection(sectionId) {
    const element = document.getElementById(sectionId);
    if (element) {
        element.scrollIntoView({ behavior: 'smooth' });
    }
    closeMobileMenu();
}

function toggleMobileMenu() {
    const mobileNav = document.getElementById('mobileNav');
    const menuIcon = document.getElementById('menuIcon');
    
    mobileNav.classList.toggle('show');
    
    if (mobileNav.classList.contains('show')) {
        menuIcon.className = 'fas fa-times';
    } else {
        menuIcon.className = 'fas fa-bars';
    }
}

function closeMobileMenu() {
    const mobileNav = document.getElementById('mobileNav');
    const menuIcon = document.getElementById('menuIcon');
    
    mobileNav.classList.remove('show');
    menuIcon.className = 'fas fa-bars';
}

// Idioma
function toggleLanguage() {
    currentLanguage = currentLanguage === 'pt' ? 'en' : 'pt';
    updateLanguage();
    closeMobileMenu();
}

function updateLanguage() {
    const t = translations[currentLanguage];
    
    // Atualizar textos da navegação
    document.getElementById('langText').textContent = currentLanguage.toUpperCase();
    document.getElementById('langTextMobile').textContent = currentLanguage.toUpperCase();
    
    // Atualizar hero
    document.getElementById('heroTitle').textContent = t.hero.title;
    document.getElementById('heroSubtitle').textContent = t.hero.subtitle;
    document.getElementById('heroCta').textContent = t.hero.cta;
    
    // Atualizar planos
    document.getElementById('plansTitle').textContent = t.plans.title;
    document.getElementById('plansSubtitle').textContent = t.plans.subtitle;
    
    // Plano Básico
    document.getElementById('basicName').textContent = t.plans.basic.name;
    document.getElementById('basicPrice').textContent = t.plans.basic.price;
    document.getElementById('basicPeriod').textContent = t.plans.basic.period;
    document.getElementById('basicBtn').textContent = t.plans.basic.button;
    updatePlanFeatures('basicFeatures', t.plans.basic.features);
    
    // Plano Pro
    document.getElementById('proName').textContent = t.plans.pro.name;
    document.getElementById('proPrice').textContent = t.plans.pro.price;
    document.getElementById('proPeriod').textContent = t.plans.pro.period;
    document.getElementById('proBtn').textContent = t.plans.pro.button;
    document.getElementById('popularBadge').textContent = t.plans.pro.popular;
    updatePlanFeatures('proFeatures', t.plans.pro.features);
    
    // Plano Premium
    document.getElementById('premiumName').textContent = t.plans.premium.name;
    document.getElementById('premiumPrice').textContent = t.plans.premium.price;
    document.getElementById('premiumPeriod').textContent = t.plans.premium.period;
    document.getElementById('premiumBtn').textContent = t.plans.premium.button;
    updatePlanFeatures('premiumFeatures', t.plans.premium.features);
    
    // Atualizar benefícios
    document.getElementById('benefitsTitle').textContent = t.benefits.title;
    document.getElementById('securityTitle').textContent = t.benefits.security.title;
    document.getElementById('securityDesc').textContent = t.benefits.security.description;
    document.getElementById('speedTitle').textContent = t.benefits.speed.title;
    document.getElementById('speedDesc').textContent = t.benefits.speed.description;
    document.getElementById('supportTitle').textContent = t.benefits.support.title;
    document.getElementById('supportDesc').textContent = t.benefits.support.description;
    
    // Atualizar depoimentos
    document.getElementById('testimonialsTitle').textContent = t.testimonials.title;
    document.getElementById('testimonial1').textContent = `"${t.testimonials.client1.text}"`;
    document.getElementById('author1').textContent = `- ${t.testimonials.client1.name}`;
    document.getElementById('testimonial2').textContent = `"${t.testimonials.client2.text}"`;
    document.getElementById('author2').textContent = `- ${t.testimonials.client2.name}`;
    document.getElementById('testimonial3').textContent = `"${t.testimonials.client3.text}"`;
    document.getElementById('author3').textContent = `- ${t.testimonials.client3.name}`;
    
    // Atualizar FAQ
    document.getElementById('faqTitle').textContent = t.faq.title;
    document.getElementById('faqQ1').querySelector('span').textContent = t.faq.q1.question;
    document.getElementById('faqA1').textContent = t.faq.q1.answer;
    document.getElementById('faqQ2').querySelector('span').textContent = t.faq.q2.question;
    document.getElementById('faqA2').textContent = t.faq.q2.answer;
    document.getElementById('faqQ3').querySelector('span').textContent = t.faq.q3.question;
    document.getElementById('faqA3').textContent = t.faq.q3.answer;
    document.getElementById('faqQ4').querySelector('span').textContent = t.faq.q4.question;
    document.getElementById('faqA4').textContent = t.faq.q4.answer;
    
    // Atualizar carrinho
    document.getElementById('cartTitle').textContent = t.cart.title;
    document.getElementById('cartEmpty').textContent = t.cart.empty;
    document.getElementById('totalLabel').textContent = t.cart.total;
    document.getElementById('checkoutBtn').textContent = t.cart.checkout;
    
    // Atualizar footer
    document.getElementById('footerText').textContent = t.footer.rights;
    
    // Atualizar carrinho se tiver itens
    if (cartItems.length > 0) {
        updateCartDisplay();
    }
}

function updatePlanFeatures(elementId, features) {
    const container = document.getElementById(elementId);
    container.innerHTML = '';
    
    features.forEach(feature => {
        const li = document.createElement('li');
        li.innerHTML = `<div class="feature-dot"></div><span>${feature}</span>`;
        container.appendChild(li);
    });
}

// Carrinho
function generateId() {
    idCounter += 1;
    return `item-${idCounter}`;
}

function addToCart(planType) {
    const t = translations[currentLanguage];
    const plans = {
        basic: { 
            name: t.plans.basic.name, 
            price: currentLanguage === 'pt' ? 97 : 29 
        },
        pro: { 
            name: t.plans.pro.name, 
            price: currentLanguage === 'pt' ? 197 : 59 
        },
        premium: { 
            name: t.plans.premium.name, 
            price: currentLanguage === 'pt' ? 297 : 89 
        }
    };

    const plan = plans[planType];
    const newItem = {
        id: generateId(),
        name: plan.name,
        price: plan.price,
        plan: planType
    };

    cartItems.push(newItem);
    updateCartCount();
    updateCartDisplay();
    toggleCart();
}

function removeFromCart(id) {
    cartItems = cartItems.filter(item => item.id !== id);
    updateCartCount();
    updateCartDisplay();
}

function updateCartCount() {
    const count = cartItems.length;
    const cartCount = document.getElementById('cartCount');
    const cartCountMobile = document.getElementById('cartCountMobile');
    
    cartCount.textContent = count;
    cartCountMobile.textContent = count;
    
    if (count > 0) {
        cartCount.classList.add('show');
        cartCountMobile.classList.add('show');
    } else {
        cartCount.classList.remove('show');
        cartCountMobile.classList.remove('show');
    }
}

function updateCartDisplay() {
    const t = translations[currentLanguage];
    const cartBody = document.getElementById('cartBody');
    const cartFooter = document.getElementById('cartFooter');
    
    if (cartItems.length === 0) {
        cartBody.innerHTML = `<p class="cart-empty">${t.cart.empty}</p>`;
        cartFooter.style.display = 'none';
    } else {
        const itemsHtml = cartItems.map(item => `
            <div class="cart-item">
                <div class="cart-item-info">
                    <h4>${item.name}</h4>
                    <p class="cart-item-price">${currentLanguage === 'pt' ? 'R$' : '$'} ${item.price}</p>
                </div>
                <button onclick="removeFromCart('${item.id}')" class="remove-btn">
                    ${t.cart.remove}
                </button>
            </div>
        `).join('');
        
        cartBody.innerHTML = `<div class="cart-items">${itemsHtml}</div>`;
        
        const total = getTotalPrice();
        document.getElementById('totalPrice').textContent = 
            `${currentLanguage === 'pt' ? 'R$' : '$'} ${total}`;
        
        cartFooter.style.display = 'block';
    }
}

function getTotalPrice() {
    return cartItems.reduce((total, item) => total + item.price, 0);
}

function toggleCart() {
    const cartModal = document.getElementById('cartModal');
    cartModal.classList.toggle('show');
    
    if (cartModal.classList.contains('show')) {
        document.body.style.overflow = 'hidden';
    } else {
        document.body.style.overflow = 'auto';
    }
}

function handleCheckout() {
    // Redirecionar para gateway de pagamento
    window.open('https://pay.hotmart.com/exemplo-checkout', '_blank');
}

// Fechar modal ao clicar fora
document.addEventListener('click', function(e) {
    const cartModal = document.getElementById('cartModal');
    const cartContent = document.querySelector('.cart-content');
    
    if (cartModal.classList.contains('show') && 
        !cartContent.contains(e.target) && 
        !e.target.closest('.cart-btn') &&
        !e.target.closest('.nav-mobile-link')) {
        toggleCart();
    }
});

// Fechar menu mobile ao clicar fora
document.addEventListener('click', function(e) {
    const mobileNav = document.getElementById('mobileNav');
    const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
    
    if (mobileNav.classList.contains('show') && 
        !mobileNav.contains(e.target) && 
        !mobileMenuBtn.contains(e.target)) {
        closeMobileMenu();
    }
});

// Fechar modal com ESC
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        const cartModal = document.getElementById('cartModal');
        if (cartModal.classList.contains('show')) {
            toggleCart();
        }
        
        const mobileNav = document.getElementById('mobileNav');
        if (mobileNav.classList.contains('show')) {
            closeMobileMenu();
        }
    }
});

// Smooth scroll para navegação interna
function smoothScroll(target) {
    const element = document.querySelector(target);
    if (element) {
        const headerHeight = document.querySelector('.header').offsetHeight;
        const elementPosition = element.offsetTop - headerHeight;
        
        window.scrollTo({
            top: elementPosition,
            behavior: 'smooth'
        });
    }
}